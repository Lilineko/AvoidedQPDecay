(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34711,        826]
NotebookOptionsPosition[     32547,        783]
NotebookOutlinePosition[     32938,        799]
CellTagsIndexPosition[     32895,        796]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"spinBasis", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "6"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.861364506588735*^9, 3.861364517418991*^9}, {
   3.8613645584315643`*^9, 3.861364736254837*^9}, 3.861369131556986*^9},
 CellLabel->
  "In[481]:=",ExpressionUUID->"aba4b40d-f45c-4cee-be3b-35ac72edaae4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.861364738991797*^9, 3.861366390791424*^9, {3.861366489659343*^9, 
   3.861366514113608*^9}, {3.861369087296357*^9, 3.861369136357025*^9}, 
   3.861370561968073*^9, 3.8613708500460253`*^9, {3.861370911054163*^9, 
   3.861370922937495*^9}, {3.861371146790442*^9, 3.861371162182349*^9}, 
   3.861417979887659*^9, 3.8619422930048656`*^9, 3.861942456752166*^9, {
   3.8619425079392023`*^9, 3.861942544358396*^9}},
 CellLabel->
  "Out[481]=",ExpressionUUID->"2b951525-be8d-49f1-b161-00276505b741"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SublatticeRotation", "[", "spinState_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mask", " ", "=", " ", 
     RowBox[{"1", "+", "4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spinState", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"BitXor", "[", 
        RowBox[{
         RowBox[{"spinState", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "mask"}], "]"}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.861364764353691*^9, 3.861364869775894*^9}, {
  3.861365008972327*^9, 3.861365009335676*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"30bec3d8-d1a1-4f2c-9b5a-9de8bfc18c92"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"magnonBasis", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SublatticeRotation", "[", "state", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"state", ",", "spinBasis"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.861364879223778*^9, 3.8613648874321547`*^9}, {
  3.8613649278745213`*^9, 3.861364970630365*^9}, {3.861365011558215*^9, 
  3.861365012076989*^9}},
 CellLabel->
  "In[483]:=",ExpressionUUID->"f583b8be-6ecf-4a01-8439-7b2662e838cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8613648887940207`*^9, 3.861364929524232*^9, 3.86136497425735*^9, 
   3.861365012469981*^9, 3.861366390977973*^9, {3.861366489704365*^9, 
   3.8613665141641903`*^9}, 3.861369136412108*^9, 3.861370562018252*^9, 
   3.8613708500927687`*^9, {3.86137091110819*^9, 3.861370922990624*^9}, {
   3.86137114683775*^9, 3.8613711622396927`*^9}, 3.861417980034775*^9, 
   3.8619422931437902`*^9, 3.86194245681105*^9, {3.861942507991205*^9, 
   3.8619425444080353`*^9}},
 CellLabel->
  "Out[483]=",ExpressionUUID->"29ba7306-0404-495d-84e0-90cbf70af555"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.861365004195663*^9, 3.861365005680244*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"5af73150-af60-44b1-a233-1d6bbdd800e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonian", "[", "state_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", "1.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"J", "=", 
       RowBox[{"0.4", "t"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", "0.0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "result", ",", "\[IndentingNewLine]", 
      "holeConfiguration", ",", "\[IndentingNewLine]", "magnonConfiguration", 
      ",", "\[IndentingNewLine]", "holePosition", ",", "\[IndentingNewLine]", 
      "hole", ",", "\[IndentingNewLine]", "holeMagnon", ",", 
      "\[IndentingNewLine]", "magnons", ",", "\[IndentingNewLine]", 
      "magnonMagnon", ",", "\[IndentingNewLine]", "diagonalTerm", ",", 
      "\[IndentingNewLine]", "newState", ",", "\[IndentingNewLine]", "i", ",",
       "j"}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"holeConfiguration", "=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "2", ",", "4"}], "]"}], "//", 
        "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"magnonConfiguration", " ", "=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "2", ",", "4"}], "]"}], "//", 
        "Reverse"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"holePosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"holeConfiguration", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hole", " ", "=", " ", "J"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"holeMagnon", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"holeMagnon", " ", "-=", 
           RowBox[{
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", "0.5", "*", "J"}]}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"holePosition", "-", "1"}], ",", "4", ",", "1"}], "]"}],
             ",", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"holePosition", "+", "1"}], ",", "4", ",", "1"}], 
             "]"}]}], "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"magnons", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"magnons", " ", "+=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"holeConfiguration", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", "J"}]}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"magnonMagnon", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "4", ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"magnonMagnon", "-=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"holeConfiguration", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"holeConfiguration", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", "J"}]}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"diagonalTerm", " ", "=", 
       RowBox[{"(*", 
        RowBox[{"hole", "+"}], "*)"}], " ", 
       RowBox[{"magnons", "+", "holeMagnon", "+", 
        RowBox[{"\[Lambda]", "*", "magnonMagnon"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"state", ",", "diagonalTerm"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "=", "holePosition"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newState", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"magnonConfiguration", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"magnonConfiguration", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", "2"}], "]"}]}], 
              "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"BitXor", "[", 
                RowBox[{
                 RowBox[{"state", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", 
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"magnonConfiguration", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"magnonConfiguration", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", "2"}], "]"}]}], 
                ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"result", ",", 
            RowBox[{"{", 
             RowBox[{"newState", ",", "t"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"holePosition", "-", "1"}], ",", "4", ",", "1"}], "]"}],
             ",", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"holePosition", "+", "1"}], ",", "4", ",", "1"}], 
             "]"}]}], "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8613650142983837`*^9, 3.861365062145691*^9}, {
   3.861365130465158*^9, 3.861365135141522*^9}, {3.861365175683276*^9, 
   3.8613652914026613`*^9}, {3.861365326679698*^9, 3.8613653291505957`*^9}, {
   3.8613654002299128`*^9, 3.8613655190121117`*^9}, {3.86136560124844*^9, 
   3.8613656826848583`*^9}, {3.861365756612472*^9, 3.861365843857181*^9}, {
   3.861365912358728*^9, 3.8613663415857563`*^9}, 3.861366388739705*^9, {
   3.861366487745617*^9, 3.861366513030916*^9}, {3.8613688541284847`*^9, 
   3.861368891996526*^9}, {3.861369202957026*^9, 3.8613692497690907`*^9}, {
   3.861369351689336*^9, 3.8613693820946417`*^9}, 3.861369426120202*^9, {
   3.86136949647666*^9, 3.861369514281455*^9}, {3.861369560540289*^9, 
   3.861369697350813*^9}, {3.861370716986479*^9, 3.861370794098013*^9}, {
   3.861370909983482*^9, 3.861370921776024*^9}, {3.861371145506646*^9, 
   3.861371161355953*^9}, {3.861417977663533*^9, 3.861417978073175*^9}, {
   3.861942291518981*^9, 3.861942291705476*^9}, {3.8619424557290707`*^9, 
   3.86194245593324*^9}, {3.861942506823398*^9, 3.861942543279009*^9}},
 CellLabel->
  "In[485]:=",ExpressionUUID->"38f27582-e20a-4fde-9ccf-031c87501e48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMatrix", "[", 
   RowBox[{"operator_", ",", "basis_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "size", ",", "\[IndentingNewLine]", "result", ",", "\[IndentingNewLine]",
       "adjacency", ",", "\[IndentingNewLine]", "adjacentState", ",", 
      "\[IndentingNewLine]", "i", ",", "j"}], "\[IndentingNewLine]", "}"}], 
    ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "basis", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", "size", ",", "size"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adjacency", "=", 
           RowBox[{"Hamiltonian", "[", "state", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"basis", ",", "state"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"adjacentState", "=", 
               RowBox[{"overlap", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"j", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"basis", ",", "adjacentState"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"result", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", 
               RowBox[{"overlap", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"overlap", ",", "adjacency"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"state", ",", "basis"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.86136636893685*^9, 3.8613663742216377`*^9}, {
  3.861366409878545*^9, 3.861366409996584*^9}, {3.861369767071999*^9, 
  3.8613700803235493`*^9}, {3.861370110999146*^9, 3.861370156329029*^9}, {
  3.861370187102666*^9, 3.8613701956324167`*^9}, {3.8613702265473747`*^9, 
  3.8613702484238863`*^9}, {3.8613704007714357`*^9, 3.861370472946787*^9}, {
  3.861370511147204*^9, 3.861370535035947*^9}, {3.8613705948997173`*^9, 
  3.861370599140697*^9}, {3.861370663396381*^9, 3.861370681539646*^9}, {
  3.861370809909095*^9, 3.8613708552985764`*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"ea8d2de9-c7e3-41b2-a460-53ac5aae1470"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"MakeMatrix", "[", 
    RowBox[{"Hamiltonian", ",", "magnonBasis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"M", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8613698680821*^9, 3.8613698852062197`*^9}, {
  3.861370934849832*^9, 3.861370945546548*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"ec30578b-1931-4ff5-ab1c-12b2a9e615ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "1.`"},
     {"0.`", "0.8000000000000002`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", 
      "0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.2`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`"},
     {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "1.`", "0.`", "0.`", "0.6000000000000001`", "0.`", "0.`", "1.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.6000000000000001`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.2`", "0.`", "0.`", "1.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.2`", "0.`", "0.`", 
      "1.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.8000000000000002`", "0.`", "0.`", "1.`"},
     {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.6000000000000001`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", 
      "0.`", "0.6000000000000001`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.861369880521235*^9, 3.861369885637312*^9}, 
   3.861370259443905*^9, 3.861370415448271*^9, {3.861370446135251*^9, 
   3.861370476129829*^9}, {3.861370524154044*^9, 3.861370562219212*^9}, 
   3.861370601876305*^9, {3.8613706694144077`*^9, 3.861370685107995*^9}, {
   3.861370850377103*^9, 3.861370857930888*^9}, {3.861370911171956*^9, 
   3.861370946254447*^9}, {3.861371146891247*^9, 3.861371162302332*^9}, 
   3.861417980115601*^9, 3.861942293217636*^9, 3.861942456871132*^9, {
   3.861942508034738*^9, 3.861942544454814*^9}},
 CellLabel->
  "Out[488]//MatrixForm=",ExpressionUUID->"86ea991e-8386-48f5-a41b-\
a99323ebb894"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
  RowBox[{"Eigensystem", "[", "M", "]"}]}]], "Input",
 CellChangeTimes->{{3.861370928310917*^9, 3.861370967549451*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"f7fb9726-94f5-49be-afb2-f87fadece320"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.4753137265165837`", ",", "2.3526568506037773`", ",", 
     "1.9579164164860914`", ",", 
     RowBox[{"-", "1.6753137265165856`"}], ",", 
     RowBox[{"-", "1.5526568506037766`"}], ",", "1.4198039027185567`", ",", 
     "1.3450253629040085`", ",", 
     RowBox[{"-", "1.1579164164860933`"}], ",", 
     RowBox[{"-", "0.6198039027185542`"}], ",", 
     RowBox[{"-", "0.5450253629040049`"}], ",", "0.40525956588231526`", ",", 
     "0.394740434117685`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.22330022342578443`"}], ",", 
       RowBox[{"-", "0.39115814937002713`"}], ",", 
       RowBox[{"-", "0.22330022342578504`"}], ",", 
       RowBox[{"-", "0.1804217550556929`"}], ",", 
       RowBox[{"-", "0.32765630843921545`"}], ",", 
       RowBox[{"-", "0.327656308439215`"}], ",", 
       RowBox[{"-", "0.22330022342578495`"}], ",", 
       RowBox[{"-", "0.22330022342578487`"}], ",", 
       RowBox[{"-", "0.3911581493700266`"}], ",", 
       RowBox[{"-", "0.32765630843921556`"}], ",", 
       RowBox[{"-", "0.1804217550556929`"}], ",", 
       RowBox[{"-", "0.32765630843921534`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.16240673771321038`"}], ",", "0.45033257205106564`", 
       ",", 
       RowBox[{"-", "0.1624067377132105`"}], ",", "1.0765710293620393`*^-16", 
       ",", "0.34960597652255365`", ",", 
       RowBox[{"-", "0.34960597652255354`"}], ",", "0.1624067377132102`", ",",
        "0.16240673771321065`", ",", 
       RowBox[{"-", "0.45033257205106597`"}], ",", "0.34960597652255326`", 
       ",", 
       RowBox[{"-", "2.220446049250313`*^-16"}], ",", 
       RowBox[{"-", "0.34960597652255404`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.34802515864017103`", ",", 
       RowBox[{"-", "5.725966152823474`*^-19"}], ",", 
       RowBox[{"-", "0.34802515864017153`"}], ",", "0.35550563416264486`", 
       ",", 
       RowBox[{"-", "0.2562935055610874`"}], ",", 
       RowBox[{"-", "0.2562935055610886`"}], ",", "0.3480251586401703`", ",", 
       
       RowBox[{"-", "0.3480251586401708`"}], ",", "2.757205221711514`*^-16", 
       ",", "0.25629350556108715`", ",", 
       RowBox[{"-", "0.3555056341626461`"}], ",", "0.256293505561089`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.32765630843922`"}], ",", 
       RowBox[{"-", "0.18042175505569227`"}], ",", 
       RowBox[{"-", "0.3276563084392114`"}], ",", "0.39115814937003374`", ",",
        "0.22330022342578196`", ",", "0.22330022342578312`", ",", 
       RowBox[{"-", "0.32765630843922`"}], ",", 
       RowBox[{"-", "0.3276563084392101`"}], ",", 
       RowBox[{"-", "0.18042175505569275`"}], ",", "0.22330022342578654`", 
       ",", "0.391158149370021`", ",", "0.2233002234257862`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.34960597652254993`", ",", 
       RowBox[{"-", "2.5309414782244443`*^-15"}], ",", 
       RowBox[{"-", "0.3496059765225564`"}], ",", 
       RowBox[{"-", "0.4503325720510618`"}], ",", "0.1624067377132138`", ",", 
       "0.1624067377132122`", ",", "0.3496059765225497`", ",", 
       RowBox[{"-", "0.34960597652255754`"}], ",", 
       RowBox[{"-", "1.7557204663715447`*^-15"}], ",", 
       RowBox[{"-", "0.16240673771320713`"}], ",", "0.45033257205107036`", 
       ",", 
       RowBox[{"-", "0.16240673771320788`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.31699445280277033`", ",", 
       RowBox[{"-", "2.8842345887824325`*^-15"}], ",", 
       RowBox[{"-", "0.31699445280276617`"}], ",", "2.412627224828524`*^-15", 
       ",", "0.38667107066895073`", ",", 
       RowBox[{"-", "0.3866710706689517`"}], ",", 
       RowBox[{"-", "0.31699445280276706`"}], ",", "0.3169944528027717`", ",", 
       RowBox[{"-", "3.1792920528031203`*^-15"}], ",", 
       RowBox[{"-", "0.3866710706689522`"}], ",", "3.969047313034935`*^-15", 
       ",", "0.3866710706689506`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.28821217759057777`"}], ",", "0.3616343966629602`", ",", 
       RowBox[{"-", "0.28821217759058315`"}], ",", 
       RowBox[{"-", "0.4285602123789099`"}], ",", "0.09854995913990408`", ",",
        "0.09854995913989813`", ",", 
       RowBox[{"-", "0.28821217759058376`"}], ",", 
       RowBox[{"-", "0.2882121775905777`"}], ",", "0.36163439666295966`", ",",
        "0.09854995913989778`", ",", 
       RowBox[{"-", "0.4285602123789089`"}], ",", "0.09854995913990386`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.25629350556108743`"}], ",", "0.3555056341626463`", ",", 
       RowBox[{"-", "0.2562935055610893`"}], ",", "1.0268280345176972`*^-16", 
       ",", 
       RowBox[{"-", "0.34802515864017114`"}], ",", "0.34802515864017136`", 
       ",", "0.2562935055610882`", ",", "0.2562935055610877`", ",", 
       RowBox[{"-", "0.35550563416264463`"}], ",", 
       RowBox[{"-", "0.3480251586401716`"}], ",", "1.7763568394002505`*^-15", 
       ",", "0.3480251586401693`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.38667107066894874`"}], ",", 
       RowBox[{"-", "1.3594388079675886`*^-14"}], ",", "0.3866710706689543`", 
       ",", 
       RowBox[{"-", "1.10478160522933`*^-14"}], ",", "0.3169944528027783`", 
       ",", 
       RowBox[{"-", "0.3169944528027601`"}], ",", "0.38667107066895345`", ",", 
       RowBox[{"-", "0.38667107066894824`"}], ",", 
       RowBox[{"-", "1.3437578455121236`*^-14"}], ",", 
       RowBox[{"-", "0.3169944528027596`"}], ",", 
       RowBox[{"-", "1.1379786002407855`*^-14"}], ",", 
       "0.31699445280277777`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.09854995913990991`"}], ",", "0.42856021237890957`", 
       ",", 
       RowBox[{"-", "0.09854995913989105`"}], ",", "0.36163439666296`", ",", 
       RowBox[{"-", "0.28821217759057244`"}], ",", 
       RowBox[{"-", "0.2882121775905884`"}], ",", 
       RowBox[{"-", "0.09854995913989097`"}], ",", 
       RowBox[{"-", "0.09854995913991046`"}], ",", "0.42856021237891007`", 
       ",", 
       RowBox[{"-", "0.2882121775905884`"}], ",", "0.3616343966629596`", ",", 
       
       RowBox[{"-", "0.28821217759057277`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.3974137523445307`", ",", "0.41329930876846`", ",", 
       "0.39741375234453313`", ",", 
       RowBox[{"-", "5.4357763325665195`*^-15"}], ",", 
       RowBox[{"-", "0.08157297428190598`"}], ",", "0.08157297428189497`", 
       ",", 
       RowBox[{"-", "0.39741375234453286`"}], ",", 
       RowBox[{"-", "0.3974137523445307`"}], ",", 
       RowBox[{"-", "0.41329930876846016`"}], ",", 
       RowBox[{"-", "0.08157297428189512`"}], ",", "5.7592819402429996`*^-15",
        ",", "0.08157297428190598`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0815729742819001`"}], ",", "1.6775080033230938`*^-15", 
       ",", "0.0815729742819019`", ",", 
       RowBox[{"-", "0.4132993087684594`"}], ",", 
       RowBox[{"-", "0.39741375234453286`"}], ",", 
       RowBox[{"-", "0.39741375234453163`"}], ",", 
       RowBox[{"-", "0.08157297428190169`"}], ",", "0.08157297428189902`", 
       ",", 
       RowBox[{"-", "2.0801721888288453`*^-15"}], ",", "0.3974137523445319`", 
       ",", "0.4132993087684601`", ",", "0.3974137523445323`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8613709494812527`*^9, 3.861370968321885*^9}, {
   3.8613711469246597`*^9, 3.861371162328775*^9}, 3.861417980159547*^9, 
   3.8619422932630777`*^9, 3.8619424569073477`*^9, {3.861942508057094*^9, 
   3.8619425444781933`*^9}},
 CellLabel->
  "Out[489]=",ExpressionUUID->"b2c87f90-9e79-4f44-a4f5-c1655270eeed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"Ordering", "[", "vals", "]"}]}]], "Input",
 CellChangeTimes->{{3.861370970601214*^9, 3.861371015552894*^9}},
 CellLabel->
  "In[490]:=",ExpressionUUID->"66541fe5-e4c1-46c8-bf34-782a1633ca48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4", ",", "5", ",", "8", ",", "9", ",", "10", ",", "12", ",", "11", ",", 
   "7", ",", "6", ",", "3", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.86137097124716*^9, {3.861371012577042*^9, 3.861371016137142*^9}, {
   3.86137114693799*^9, 3.8613711623419037`*^9}, 3.86141798017947*^9, 
   3.86194229328555*^9, 3.861942456922916*^9, {3.861942508083952*^9, 
   3.861942544491913*^9}},
 CellLabel->
  "Out[490]=",ExpressionUUID->"f4ced4d0-5821-4fed-a651-f58b93c35029"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vals", "[", 
  RowBox[{"[", "P", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"gs", "=", 
  RowBox[{"2", "*", 
   RowBox[{
    RowBox[{
     RowBox[{"vecs", "[", 
      RowBox[{"[", "P", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}]}]}], "Input",
 CellChangeTimes->{{3.861371018088653*^9, 3.861371053074421*^9}, {
  3.8613711049262037`*^9, 3.8613711170447903`*^9}, {3.861371314325594*^9, 
  3.861371315146274*^9}, {3.861942800551648*^9, 3.861942825289452*^9}, {
  3.8619430150508432`*^9, 3.861943017860402*^9}},
 CellLabel->
  "In[505]:=",ExpressionUUID->"860cdb4e-1d91-43de-bea7-4d3a06bbf4b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.6753137265165856`"}], ",", 
   RowBox[{"-", "1.5526568506037766`"}], ",", 
   RowBox[{"-", "1.1579164164860933`"}], ",", 
   RowBox[{"-", "0.6198039027185542`"}], ",", 
   RowBox[{"-", "0.5450253629040049`"}], ",", "0.394740434117685`", ",", 
   "0.40525956588231526`", ",", "1.3450253629040085`", ",", 
   "1.4198039027185567`", ",", "1.9579164164860914`", ",", 
   "2.3526568506037773`", ",", "2.4753137265165837`"}], "}"}]], "Output",
 CellChangeTimes->{{3.861371020501259*^9, 3.861371053528298*^9}, {
   3.8613711061611757`*^9, 3.861371162365239*^9}, 3.861371315652685*^9, 
   3.861417980204805*^9, 3.8619422933124657`*^9, 3.8619424569512978`*^9, {
   3.86194250810712*^9, 3.861942544515633*^9}, {3.86194280114185*^9, 
   3.861942825578306*^9}, 3.861943018316964*^9},
 CellLabel->
  "Out[505]=",ExpressionUUID->"b7d4ec4b-882c-409c-b16a-ae4931617de2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.21471731292003454`", ",", "0.06510401939475244`", ",", 
   "0.21471731292002327`", ",", "0.30600939563717927`", ",", 
   "0.09972597956400828`", ",", "0.09972597956400932`", ",", 
   "0.21471731292003454`", ",", "0.21471731292002158`", ",", 
   "0.06510401939475279`", ",", "0.09972597956401237`", ",", 
   "0.30600939563715934`", ",", "0.09972597956401208`"}], "}"}]], "Output",
 CellChangeTimes->{{3.861371020501259*^9, 3.861371053528298*^9}, {
   3.8613711061611757`*^9, 3.861371162365239*^9}, 3.861371315652685*^9, 
   3.861417980204805*^9, 3.8619422933124657`*^9, 3.8619424569512978`*^9, {
   3.86194250810712*^9, 3.861942544515633*^9}, {3.86194280114185*^9, 
   3.861942825578306*^9}, 3.8619430183241653`*^9},
 CellLabel->
  "Out[506]=",ExpressionUUID->"07dc2d2d-41fc-4cf7-9325-a3e6072e5edd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"0.06510401939475256", ",", "0.09972597956400954", ",", 
  "0.2147173129200263", ",", "0.3060093956371692", ",", "0.21471731292003068",
   ",", "0.09972597956401168", ",", "0.06510401939475256"}]], "Input",
 CellChangeTimes->{{3.8619427725621233`*^9, 
  3.861942772570302*^9}},ExpressionUUID->"2806fee0-98fc-4204-92ce-\
680fe333014c"]
},
WindowSize->{1440, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"47f76371-d110-4136-b7ee-8dd2f8197fd1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1043, 31, 30, "Input",ExpressionUUID->"aba4b40d-f45c-4cee-be3b-35ac72edaae4"],
Cell[1626, 55, 1281, 35, 34, "Output",ExpressionUUID->"2b951525-be8d-49f1-b161-00276505b741"]
}, Open  ]],
Cell[2922, 93, 790, 20, 94, "Input",ExpressionUUID->"30bec3d8-d1a1-4f2c-9b5a-9de8bfc18c92"],
Cell[CellGroupData[{
Cell[3737, 117, 480, 11, 30, "Input",ExpressionUUID->"f583b8be-6ecf-4a01-8439-7b2662e838cd"],
Cell[4220, 130, 1329, 36, 34, "Output",ExpressionUUID->"29ba7306-0404-495d-84e0-90cbf70af555"]
}, Open  ]],
Cell[5564, 169, 175, 3, 30, "Input",ExpressionUUID->"5af73150-af60-44b1-a233-1d6bbdd800e4"],
Cell[5742, 174, 9060, 205, 1144, "Input",ExpressionUUID->"38f27582-e20a-4fde-9ccf-031c87501e48"],
Cell[14805, 381, 3204, 73, 451, "Input",ExpressionUUID->"ea8d2de9-c7e3-41b2-a460-53ac5aae1470"],
Cell[CellGroupData[{
Cell[18034, 458, 413, 10, 52, "Input",ExpressionUUID->"ec30578b-1931-4ff5-ab1c-12b2a9e615ff"],
Cell[18450, 470, 2371, 48, 230, "Output",ExpressionUUID->"86ea991e-8386-48f5-a41b-a99323ebb894"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20858, 523, 289, 7, 30, "Input",ExpressionUUID->"f7fb9726-94f5-49be-afb2-f87fadece320"],
Cell[21150, 532, 7776, 161, 307, "Output",ExpressionUUID->"b2c87f90-9e79-4f44-a4f5-c1655270eeed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28963, 698, 236, 5, 30, "Input",ExpressionUUID->"66541fe5-e4c1-46c8-bf34-782a1633ca48"],
Cell[29202, 705, 525, 11, 34, "Output",ExpressionUUID->"f4ced4d0-5821-4fed-a651-f58b93c35029"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29764, 721, 645, 15, 52, "Input",ExpressionUUID->"860cdb4e-1d91-43de-bea7-4d3a06bbf4b4"],
Cell[30412, 738, 913, 17, 34, "Output",ExpressionUUID->"b7d4ec4b-882c-409c-b16a-ae4931617de2"],
Cell[31328, 757, 843, 15, 34, "Output",ExpressionUUID->"07dc2d2d-41fc-4cf7-9325-a3e6072e5edd"]
}, Open  ]],
Cell[32186, 775, 357, 6, 30, "Input",ExpressionUUID->"2806fee0-98fc-4204-92ce-680fe333014c"]
}
]
*)

