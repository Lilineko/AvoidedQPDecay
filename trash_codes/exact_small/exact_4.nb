(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54091,       1193]
NotebookOptionsPosition[     50574,       1126]
NotebookOutlinePosition[     50965,       1142]
CellTagsIndexPosition[     50922,       1139]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"spinBasis", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "6"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.861364506588735*^9, 3.861364517418991*^9}, {
   3.8613645584315643`*^9, 3.861364736254837*^9}, 3.861369131556986*^9},
 CellLabel->
  "In[1270]:=",ExpressionUUID->"aba4b40d-f45c-4cee-be3b-35ac72edaae4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.861364738991797*^9, 3.861366390791424*^9, {3.861366489659343*^9, 
   3.861366514113608*^9}, {3.861369087296357*^9, 3.861369136357025*^9}, 
   3.861370561968073*^9, 3.8613708500460253`*^9, {3.861370911054163*^9, 
   3.861370922937495*^9}, {3.861371146790442*^9, 3.861371162182349*^9}, 
   3.861417979887659*^9, 3.8619422930048656`*^9, 3.861942456752166*^9, {
   3.8619425079392023`*^9, 3.861942544358396*^9}, 3.86194631496029*^9, 
   3.8619468942755947`*^9, {3.861946949349221*^9, 3.861946980862865*^9}, {
   3.861947087506857*^9, 3.861947111925893*^9}, {3.861947689401059*^9, 
   3.861947712362488*^9}, 3.8619477968564243`*^9, 3.861947963444704*^9, 
   3.8619483147265577`*^9, 3.8619487724784317`*^9, 3.8620234785257263`*^9, {
   3.862030566441882*^9, 3.862030620409649*^9}, 3.862035134047679*^9, 
   3.862040685621161*^9, {3.862040773924806*^9, 3.8620408348718443`*^9}, 
   3.862041961830155*^9, 3.862042474048053*^9, 3.862042548980714*^9, 
   3.862043033092102*^9, {3.862043524387806*^9, 3.8620435340573177`*^9}, {
   3.8620450157074747`*^9, 3.862045023697331*^9}, 3.862045181593603*^9, 
   3.862045243267288*^9, {3.862117612350144*^9, 3.862117629580153*^9}, 
   3.86211830211344*^9, 3.862118651756369*^9, 3.862118823777108*^9, 
   3.862119022101973*^9, 3.8621190709043407`*^9, {3.862119106348669*^9, 
   3.8621191119655943`*^9}, 3.862119202793919*^9, {3.86211961676547*^9, 
   3.862119631921013*^9}, {3.862119719735968*^9, 3.862119742989636*^9}, 
   3.862119801269655*^9, 3.862119850373989*^9},
 CellLabel->
  "Out[1270]=",ExpressionUUID->"de60185b-0824-4102-8b70-ec0ebc76526b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SublatticeRotation", "[", "spinState_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mask", " ", "=", " ", 
     RowBox[{"1", "+", "4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spinState", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"BitXor", "[", 
        RowBox[{
         RowBox[{"spinState", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "mask"}], "]"}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.861364764353691*^9, 3.861364869775894*^9}, {
  3.861365008972327*^9, 3.861365009335676*^9}},
 CellLabel->
  "In[1271]:=",ExpressionUUID->"30bec3d8-d1a1-4f2c-9b5a-9de8bfc18c92"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"magnonBasis", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SublatticeRotation", "[", "state", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"state", ",", "spinBasis"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.861364879223778*^9, 3.8613648874321547`*^9}, {
  3.8613649278745213`*^9, 3.861364970630365*^9}, {3.861365011558215*^9, 
  3.861365012076989*^9}},
 CellLabel->
  "In[1272]:=",ExpressionUUID->"f583b8be-6ecf-4a01-8439-7b2662e838cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8613648887940207`*^9, 3.861364929524232*^9, 3.86136497425735*^9, 
   3.861365012469981*^9, 3.861366390977973*^9, {3.861366489704365*^9, 
   3.8613665141641903`*^9}, 3.861369136412108*^9, 3.861370562018252*^9, 
   3.8613708500927687`*^9, {3.86137091110819*^9, 3.861370922990624*^9}, {
   3.86137114683775*^9, 3.8613711622396927`*^9}, 3.861417980034775*^9, 
   3.8619422931437902`*^9, 3.86194245681105*^9, {3.861942507991205*^9, 
   3.8619425444080353`*^9}, 3.861946315063252*^9, 3.861946894326302*^9, {
   3.861946949398164*^9, 3.861946980913457*^9}, {3.8619470875559597`*^9, 
   3.861947111977023*^9}, {3.8619476894511013`*^9, 3.861947712412908*^9}, 
   3.861947796913759*^9, 3.861947963505619*^9, 3.861948314835408*^9, 
   3.861948772530581*^9, 3.8620234786579533`*^9, {3.8620305665887136`*^9, 
   3.862030620470306*^9}, 3.8620351341472073`*^9, 3.862040685681168*^9, {
   3.8620407739763727`*^9, 3.862040834923605*^9}, 3.8620419618776913`*^9, 
   3.862042474109152*^9, 3.862042549033285*^9, 3.86204303314583*^9, {
   3.8620435244468403`*^9, 3.862043534117313*^9}, {3.862045015809515*^9, 
   3.862045023757566*^9}, 3.862045181655325*^9, 3.8620452433283253`*^9, {
   3.862117612403305*^9, 3.862117629642417*^9}, 3.862118302172433*^9, 
   3.862118651815032*^9, 3.862118823831896*^9, 3.862119022166189*^9, 
   3.8621190709536533`*^9, {3.862119106409277*^9, 3.862119112018832*^9}, 
   3.8621192028453827`*^9, {3.8621196168275967`*^9, 3.862119631983639*^9}, {
   3.862119719864401*^9, 3.862119743042671*^9}, 3.8621198013266582`*^9, 
   3.862119850436913*^9},
 CellLabel->
  "Out[1272]=",ExpressionUUID->"c6a7a662-20f3-47e7-aff2-0e31c22cf5d5"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.861365004195663*^9, 3.861365005680244*^9}},
 CellLabel->
  "In[1273]:=",ExpressionUUID->"5af73150-af60-44b1-a233-1d6bbdd800e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hamiltonian", "[", "state_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", "1.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"J", "=", 
       RowBox[{"0.4", "t"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"Lb", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "result", ",", "\[IndentingNewLine]", 
      "holeConfiguration", ",", "\[IndentingNewLine]", "magnonConfiguration", 
      ",", "\[IndentingNewLine]", "holePosition", ",", "\[IndentingNewLine]", 
      "hole", ",", "\[IndentingNewLine]", "holeMagnon", ",", 
      "\[IndentingNewLine]", "magnons", ",", "\[IndentingNewLine]", 
      "magnonMagnon", ",", "\[IndentingNewLine]", "diagonalTerm", ",", 
      "\[IndentingNewLine]", "newState", ",", "\[IndentingNewLine]", "i", ",",
       "j"}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"holeConfiguration", "=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "2", ",", "4"}], "]"}], "//", 
        "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"magnonConfiguration", " ", "=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "2", ",", "4"}], "]"}], "//", 
        "Reverse"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"holePosition", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"holeConfiguration", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hole", " ", "=", " ", "J"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"holeMagnon", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"holeMagnon", " ", "-=", 
           RowBox[{
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", "0.5", "*", "J"}]}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"holePosition", "-", "1"}], ",", "4", ",", "1"}], "]"}],
             ",", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"holePosition", "+", "1"}], ",", "4", ",", "1"}], 
             "]"}]}], "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"magnons", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"magnons", " ", "+=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"holeConfiguration", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", "J"}]}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"magnonMagnon", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "4", ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"magnonMagnon", "-=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"holeConfiguration", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"holeConfiguration", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"magnonConfiguration", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", "J"}]}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"diagonalTerm", " ", "=", 
       RowBox[{"hole", "+", " ", "magnons", "+", 
        RowBox[{"\[Lambda]", "*", 
         RowBox[{"(", 
          RowBox[{"magnonMagnon", "+", "holeMagnon"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"state", ",", "diagonalTerm"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "=", "holePosition"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newState", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"magnonConfiguration", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"magnonConfiguration", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", "2"}], "]"}]}], 
              "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"BitXor", "[", 
                RowBox[{
                 RowBox[{"state", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", 
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"magnonConfiguration", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"magnonConfiguration", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", "2"}], "]"}]}], 
                ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"result", ",", 
            RowBox[{"{", 
             RowBox[{"newState", ",", "t"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "4", ",", "1"}], "]"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "4", ",", "1"}], "]"}]}], "}"}]}],
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "4", ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"magnonConfiguration", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"magnonConfiguration", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", "2"}], "]"}], "==", 
               "0"}], ")"}], " ", "&&", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"holeConfiguration", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", 
                 RowBox[{"holeConfiguration", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "==", "0"}], 
              ")"}]}], ",", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newState", "=", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"2", "^", 
                  RowBox[{"(", 
                   RowBox[{"holePosition", "-", "1"}], ")"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BitXor", "[", 
                  RowBox[{
                   RowBox[{"state", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", 
                    RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"result", ",", 
                RowBox[{"{", 
                 RowBox[{"newState", ",", 
                  RowBox[{"J", "/", "2"}]}], "}"}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8613650142983837`*^9, 3.861365062145691*^9}, {
   3.861365130465158*^9, 3.861365135141522*^9}, {3.861365175683276*^9, 
   3.8613652914026613`*^9}, {3.861365326679698*^9, 3.8613653291505957`*^9}, {
   3.8613654002299128`*^9, 3.8613655190121117`*^9}, {3.86136560124844*^9, 
   3.8613656826848583`*^9}, {3.861365756612472*^9, 3.861365843857181*^9}, {
   3.861365912358728*^9, 3.8613663415857563`*^9}, 3.861366388739705*^9, {
   3.861366487745617*^9, 3.861366513030916*^9}, {3.8613688541284847`*^9, 
   3.861368891996526*^9}, {3.861369202957026*^9, 3.8613692497690907`*^9}, {
   3.861369351689336*^9, 3.8613693820946417`*^9}, 3.861369426120202*^9, {
   3.86136949647666*^9, 3.861369514281455*^9}, {3.861369560540289*^9, 
   3.861369697350813*^9}, {3.861370716986479*^9, 3.861370794098013*^9}, {
   3.861370909983482*^9, 3.861370921776024*^9}, {3.861371145506646*^9, 
   3.861371161355953*^9}, {3.861417977663533*^9, 3.861417978073175*^9}, {
   3.861942291518981*^9, 3.861942291705476*^9}, {3.8619424557290707`*^9, 
   3.86194245593324*^9}, {3.861942506823398*^9, 3.861942543279009*^9}, {
   3.861946288509149*^9, 3.861946329049656*^9}, {3.861946449319318*^9, 
   3.861946453512726*^9}, {3.8619464949102383`*^9, 3.861946531961624*^9}, {
   3.861946638740588*^9, 3.861946643031602*^9}, {3.861946681583768*^9, 
   3.861946793995371*^9}, {3.8619468323519373`*^9, 3.861946838879354*^9}, {
   3.8619468873309107`*^9, 3.861946906728594*^9}, {3.8619469484325743`*^9, 
   3.8619469801578093`*^9}, {3.861947040905407*^9, 3.8619471112087708`*^9}, {
   3.861947660818389*^9, 3.861947711577676*^9}, {3.8619477930029497`*^9, 
   3.861947795470375*^9}, {3.861947961616763*^9, 3.861947962160187*^9}, {
   3.8619487712846413`*^9, 3.861948771493128*^9}, {3.862023463467566*^9, 
   3.8620234693005447`*^9}, {3.862030557563788*^9, 3.8620306184027767`*^9}, {
   3.8620351261274567`*^9, 3.862035127835573*^9}, {3.8620406531840467`*^9, 
   3.8620406844230003`*^9}, {3.862040767375579*^9, 3.862040834170434*^9}, 
   3.862041960543825*^9, {3.862042462443935*^9, 3.862042468089986*^9}, 
   3.862042547468711*^9, 3.862043030768495*^9, {3.8620435120654707`*^9, 
   3.862043533260872*^9}, {3.862045012817985*^9, 3.8620450225296926`*^9}, {
   3.862045178281685*^9, 3.862045180762589*^9}, 3.862045242191999*^9, 
   3.862117585377095*^9, {3.8621176280465727`*^9, 3.862117628450808*^9}, {
   3.862118257797139*^9, 3.862118262054389*^9}, 3.8621182994439163`*^9, {
   3.862118650561516*^9, 3.862118650699663*^9}, {3.862118821101141*^9, 
   3.862118821240086*^9}, {3.8621190172958717`*^9, 3.862119019352065*^9}, {
   3.862119109646472*^9, 3.862119111028042*^9}, {3.8621191995569773`*^9, 
   3.8621192018637*^9}, {3.862119630705139*^9, 3.862119630882436*^9}, {
   3.862119717152122*^9, 3.8621197420441227`*^9}, {3.862119795039825*^9, 
   3.862119799941352*^9}, {3.8621198491929207`*^9, 3.86211984935413*^9}, {
   3.86212049498698*^9, 
   3.862120495139728*^9}},ExpressionUUID->"38f27582-e20a-4fde-9ccf-\
031c87501e48"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[1275]:=",ExpressionUUID->"3bec1489-3d1a-4fc2-b213-c7bc8724debc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMatrix", "[", 
   RowBox[{"operator_", ",", "basis_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "size", ",", "\[IndentingNewLine]", "result", ",", "\[IndentingNewLine]",
       "adjacency", ",", "\[IndentingNewLine]", "adjacentState", ",", 
      "\[IndentingNewLine]", "i", ",", "j"}], "\[IndentingNewLine]", "}"}], 
    ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "basis", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", "size", ",", "size"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adjacency", "=", 
           RowBox[{"Hamiltonian", "[", "state", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"basis", ",", "state"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"adjacentState", "=", 
               RowBox[{"overlap", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"j", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"basis", ",", "adjacentState"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"result", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", 
               RowBox[{"overlap", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"overlap", ",", "adjacency"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"state", ",", "basis"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.86136636893685*^9, 3.8613663742216377`*^9}, {
  3.861366409878545*^9, 3.861366409996584*^9}, {3.861369767071999*^9, 
  3.8613700803235493`*^9}, {3.861370110999146*^9, 3.861370156329029*^9}, {
  3.861370187102666*^9, 3.8613701956324167`*^9}, {3.8613702265473747`*^9, 
  3.8613702484238863`*^9}, {3.8613704007714357`*^9, 3.861370472946787*^9}, {
  3.861370511147204*^9, 3.861370535035947*^9}, {3.8613705948997173`*^9, 
  3.861370599140697*^9}, {3.861370663396381*^9, 3.861370681539646*^9}, {
  3.861370809909095*^9, 3.8613708552985764`*^9}},
 CellLabel->
  "In[1276]:=",ExpressionUUID->"ea8d2de9-c7e3-41b2-a460-53ac5aae1470"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"MakeMatrix", "[", 
    RowBox[{"Hamiltonian", ",", "magnonBasis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"M", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8613698680821*^9, 3.8613698852062197`*^9}, {
  3.861370934849832*^9, 3.861370945546548*^9}},
 CellLabel->
  "In[1277]:=",ExpressionUUID->"ec30578b-1931-4ff5-ab1c-12b2a9e615ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6019801980198021`", "0.2`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "1.`"},
     {"0.2`", "0.4118811881188118`", "0.2`", "0.`", "1.`", "0.`", "0.`", 
      "0.`", "0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.2`", "0.6019801980198021`", "0.`", "0.`", "1.`", "0.`", "0.`",
       "0.`", "0.`", "1.`", "0.`"},
     {"1.`", "0.`", "0.`", "0.4`", "0.2`", "0.2`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`"},
     {"0.`", "1.`", "0.`", "0.2`", "0.605940594059406`", "0.`", "0.`", "1.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.2`", "0.`", "0.605940594059406`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.6019801980198021`", "0.`", 
      "0.2`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.6019801980198021`", 
      "0.2`", "0.`", "1.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.2`", "0.2`", 
      "0.4118811881188118`", "0.`", "0.`", "1.`"},
     {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.605940594059406`", "0.2`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.2`", 
      "0.4`", "0.2`"},
     {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", 
      "0.2`", "0.605940594059406`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.861369880521235*^9, 3.861369885637312*^9}, 
   3.861370259443905*^9, 3.861370415448271*^9, {3.861370446135251*^9, 
   3.861370476129829*^9}, {3.861370524154044*^9, 3.861370562219212*^9}, 
   3.861370601876305*^9, {3.8613706694144077`*^9, 3.861370685107995*^9}, {
   3.861370850377103*^9, 3.861370857930888*^9}, {3.861370911171956*^9, 
   3.861370946254447*^9}, {3.861371146891247*^9, 3.861371162302332*^9}, 
   3.861417980115601*^9, 3.861942293217636*^9, 3.861942456871132*^9, {
   3.861942508034738*^9, 3.861942544454814*^9}, 3.8619463151211653`*^9, 
   3.8619468945529623`*^9, {3.861946949462369*^9, 3.861946981189933*^9}, {
   3.8619470876170073`*^9, 3.8619471120403423`*^9}, {3.861947689529171*^9, 
   3.861947712465763*^9}, 3.861947796974639*^9, 3.8619479635609503`*^9, 
   3.861948314903143*^9, 3.861948772607368*^9, 3.8620234787383957`*^9, {
   3.862030566660331*^9, 3.862030620540309*^9}, 3.862035134214707*^9, 
   3.86204068572711*^9, {3.8620407740844803`*^9, 3.86204083498415*^9}, 
   3.862041961937028*^9, 3.8620424741767893`*^9, 3.862042549101173*^9, 
   3.8620430332052727`*^9, {3.8620435245092707`*^9, 3.862043534181601*^9}, {
   3.862045015871916*^9, 3.862045023807295*^9}, 3.862045181730789*^9, 
   3.862045243387664*^9, {3.8621176124751053`*^9, 3.8621176297117023`*^9}, 
   3.86211830224946*^9, 3.862118651882679*^9, 3.862118823898594*^9, 
   3.862119022217903*^9, 3.862119071017762*^9, {3.862119106475667*^9, 
   3.862119112092492*^9}, 3.862119202916646*^9, {3.862119616907425*^9, 
   3.8621196320530577`*^9}, {3.862119719945327*^9, 3.862119743110273*^9}, 
   3.8621198013966084`*^9, 3.862119850504079*^9},
 CellLabel->
  "Out[1278]//MatrixForm=",ExpressionUUID->"0d04e2ac-2c19-4906-858c-\
bd7df60869c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
  RowBox[{"Eigensystem", "[", "M", "]"}]}]], "Input",
 CellChangeTimes->{{3.861370928310917*^9, 3.861370967549451*^9}},
 CellLabel->
  "In[1279]:=",ExpressionUUID->"f7fb9726-94f5-49be-afb2-f87fadece320"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.80462953540716`", ",", "2.1506765404921953`", ",", 
     "2.1455423629758865`", ",", "1.6039623566297818`", ",", 
     RowBox[{"-", "1.341581416633344`"}], ",", 
     RowBox[{"-", "1.3361535811007863`"}], ",", "1.2052776162079883`", ",", 
     RowBox[{"-", "1.1954147775043449`"}], ",", "0.8052790208066084`", ",", 
     "0.8039598457366567`", ",", 
     RowBox[{"-", "0.7946903939127806`"}], ",", 
     RowBox[{"-", "0.39604156455057327`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.28819210251595956`"}], ",", 
       RowBox[{"-", "0.2897823870308213`"}], ",", 
       RowBox[{"-", "0.2881921025159598`"}], ",", 
       RowBox[{"-", "0.28777992292343985`"}], ",", 
       RowBox[{"-", "0.2890497433174431`"}], ",", 
       RowBox[{"-", "0.28904974331744465`"}], ",", 
       RowBox[{"-", "0.2881921025159599`"}], ",", 
       RowBox[{"-", "0.2881921025159591`"}], ",", 
       RowBox[{"-", "0.289782387030822`"}], ",", 
       RowBox[{"-", "0.28904974331744315`"}], ",", 
       RowBox[{"-", "0.28777992292343846`"}], ",", 
       RowBox[{"-", "0.2890497433174427`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.19119869575987367`", ",", 
       RowBox[{"-", "0.385225391168507`"}], ",", "0.19119869575909546`", ",", 
       "4.006647063583129`*^-13", ",", 
       RowBox[{"-", "0.3731537990421071`"}], ",", "0.3731537990417066`", ",", 
       
       RowBox[{"-", "0.19119869575909418`"}], ",", 
       RowBox[{"-", "0.1911986957598736`"}], ",", "0.3852253911685072`", ",", 
       
       RowBox[{"-", "0.37315379904170587`"}], ",", 
       RowBox[{"-", "3.9998503766181636`*^-13"}], ",", 
       "0.3731537990421065`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3732800662186174`", ",", "3.245659906758226`*^-13", ",", 
       RowBox[{"-", "0.37328006621894017`"}], ",", "0.38355368941123336`", 
       ",", 
       RowBox[{"-", "0.1926272977360648`"}], ",", 
       RowBox[{"-", "0.19262729773669396`"}], ",", "0.3732800662189407`", ",", 
       RowBox[{"-", "0.3732800662186177`"}], ",", 
       RowBox[{"-", "3.248714908231121`*^-13"}], ",", "0.19262729773669388`", 
       ",", 
       RowBox[{"-", "0.3835536894112331`"}], ",", "0.1926272977360636`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.35320316495300424`"}], ",", 
       RowBox[{"-", "3.2256370976847574`*^-17"}], ",", "0.353203164953003`", 
       ",", 
       RowBox[{"-", "6.408456915658348`*^-16"}], ",", 
       RowBox[{"-", "0.3539032696474865`"}], ",", "0.35390326964748553`", ",",
        "0.35320316495300313`", ",", 
       RowBox[{"-", "0.3532031649530028`"}], ",", 
       RowBox[{"-", "1.342839523640462`*^-15"}], ",", "0.35390326964748714`", 
       ",", "6.658726832500557`*^-16", ",", 
       RowBox[{"-", "0.35390326964748703`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3326579057486383`", ",", "2.2896172454026316`*^-14", ",", 
       RowBox[{"-", "0.3326579057486606`"}], ",", 
       RowBox[{"-", "0.43142523505800234`"}], ",", "0.21511590136595868`", 
       ",", "0.2151159013659936`", ",", "0.3326579057486613`", ",", 
       RowBox[{"-", "0.3326579057486378`"}], ",", 
       RowBox[{"-", "2.2600356688216745`*^-14"}], ",", 
       RowBox[{"-", "0.21511590136599393`"}], ",", "0.4314252350580019`", ",", 
       RowBox[{"-", "0.21511590136595954`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.21610552436802902`"}], ",", "0.4302188475968553`", ",", 
       RowBox[{"-", "0.21610552436799502`"}], ",", "2.163028047732505`*^-14", 
       ",", 
       RowBox[{"-", "0.33279764711285365`"}], ",", "0.33279764711283`", ",", 
       "0.21610552436799602`", ",", "0.2161055243680306`", ",", 
       RowBox[{"-", "0.4302188475968537`"}], ",", 
       RowBox[{"-", "0.3327976471128312`"}], ",", 
       RowBox[{"-", "2.3303450841528992`*^-14"}], ",", 
       "0.33279764711285276`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2050215309263147`"}], ",", "0.4083586461191934`", ",", 
       
       RowBox[{"-", "0.20502153092631523`"}], ",", 
       RowBox[{"-", "0.40836014129508624`"}], ",", "0.2029994517904131`", ",",
        "0.20299945179041298`", ",", 
       RowBox[{"-", "0.20502153092631484`"}], ",", 
       RowBox[{"-", "0.20502153092631567`"}], ",", "0.4083586461191937`", ",",
        "0.20299945179041323`", ",", 
       RowBox[{"-", "0.4083601412950867`"}], ",", "0.20299945179041304`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.29059373208209205`"}], ",", 
       RowBox[{"-", "0.2846595820066342`"}], ",", 
       RowBox[{"-", "0.29059373208209316`"}], ",", "0.2923587850804515`", ",",
        "0.2868848452840366`", ",", "0.28688484528403846`", ",", 
       RowBox[{"-", "0.29059373208209166`"}], ",", 
       RowBox[{"-", "0.290593732082092`"}], ",", 
       RowBox[{"-", "0.28465958200663577`"}], ",", "0.28688484528403696`", 
       ",", "0.29235878508045254`", ",", "0.28688484528403846`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.408339884260035`", ",", "0.4080602175800838`", ",", 
       "0.4083398842600346`", ",", "6.4383005517166`*^-14", ",", 
       RowBox[{"-", "0.0014029742508848175`"}], ",", "0.0014029742510131044`",
        ",", 
       RowBox[{"-", "0.4083398842600343`"}], ",", 
       RowBox[{"-", "0.4083398842600349`"}], ",", 
       RowBox[{"-", "0.40806021758008393`"}], ",", 
       RowBox[{"-", "0.0014029742510130608`"}], ",", 
       RowBox[{"-", "6.415516172054778`*^-14"}], ",", 
       "0.0014029742508848587`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0008425595686074881`", ",", 
       RowBox[{"-", "6.412355599052684`*^-14"}], ",", 
       RowBox[{"-", "0.0008425595687371208`"}], ",", "0.40836115620144214`", 
       ",", "0.4081909763165818`", ",", "0.40819097631658097`", ",", 
       "0.0008425595687363881`", ",", 
       RowBox[{"-", "0.0008425595686088705`"}], ",", 
       "6.358900103819103`*^-14", ",", 
       RowBox[{"-", "0.40819097631658113`"}], ",", 
       RowBox[{"-", "0.4083611562014425`"}], ",", 
       RowBox[{"-", "0.4081909763165817`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.20116353242738044`"}], ",", "0.4101686320017979`", ",", 
       RowBox[{"-", "0.2011635324273816`"}], ",", "0.4061416646318359`", ",", 
       
       RowBox[{"-", "0.20721620112159642`"}], ",", 
       RowBox[{"-", "0.20721620112159528`"}], ",", 
       RowBox[{"-", "0.20116353242738144`"}], ",", 
       RowBox[{"-", "0.2011635324273801`"}], ",", "0.41016863200179765`", ",", 
       RowBox[{"-", "0.20721620112159514`"}], ",", "0.40614166463183593`", 
       ",", 
       RowBox[{"-", "0.20721620112159655`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.3539032696474868`"}], ",", "7.269654979014086`*^-16", 
       ",", "0.3539032696474859`", ",", "1.002093689399712`*^-15", ",", 
       "0.35320316495300275`", ",", 
       RowBox[{"-", "0.35320316495300347`"}], ",", "0.35390326964748614`", 
       ",", 
       RowBox[{"-", "0.353903269647487`"}], ",", "8.815091388115718`*^-16", 
       ",", 
       RowBox[{"-", "0.3532031649530036`"}], ",", "9.847474903673766`*^-16", 
       ",", "0.35320316495300336`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8613709494812527`*^9, 3.861370968321885*^9}, {
   3.8613711469246597`*^9, 3.861371162328775*^9}, 3.861417980159547*^9, 
   3.8619422932630777`*^9, 3.8619424569073477`*^9, {3.861942508057094*^9, 
   3.8619425444781933`*^9}, 3.861946315149598*^9, 3.861946894595245*^9, {
   3.8619469494790373`*^9, 3.8619469812293797`*^9}, {3.861947087640621*^9, 
   3.861947112069878*^9}, {3.8619476895943117`*^9, 3.8619477124892197`*^9}, 
   3.861947797008525*^9, 3.861947963588374*^9, 3.861948314925068*^9, 
   3.861948772631166*^9, 3.862023478789328*^9, {3.862030566677402*^9, 
   3.8620306205537863`*^9}, 3.862035134241274*^9, 3.862040685754508*^9, {
   3.862040774098*^9, 3.862040834996828*^9}, 3.862041961963932*^9, 
   3.862042474203621*^9, 3.862042549147896*^9, 3.862043033224568*^9, {
   3.862043524534698*^9, 3.862043534215996*^9}, {3.8620450158981733`*^9, 
   3.862045023838849*^9}, 3.862045181745431*^9, 3.862045243403118*^9, {
   3.8621176125181*^9, 3.8621176297412443`*^9}, 3.8621183022766523`*^9, 
   3.8621186519110823`*^9, 3.862118823925137*^9, 3.862119022246161*^9, 
   3.862119071030982*^9, {3.862119106492238*^9, 3.8621191121242847`*^9}, 
   3.8621192029430227`*^9, {3.862119616923231*^9, 3.862119632069219*^9}, {
   3.862119719986215*^9, 3.862119743140382*^9}, 3.8621198014259872`*^9, 
   3.862119850538145*^9},
 CellLabel->
  "Out[1279]=",ExpressionUUID->"4d8c671e-2b6b-4ec5-9d50-a6e82f116dae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"Ordering", "[", "vals", "]"}]}]], "Input",
 CellChangeTimes->{{3.861370970601214*^9, 3.861371015552894*^9}},
 CellLabel->
  "In[1280]:=",ExpressionUUID->"66541fe5-e4c1-46c8-bf34-782a1633ca48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5", ",", "6", ",", "8", ",", "11", ",", "12", ",", "10", ",", "9", ",", 
   "7", ",", "4", ",", "3", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.86137097124716*^9, {3.861371012577042*^9, 3.861371016137142*^9}, {
   3.86137114693799*^9, 3.8613711623419037`*^9}, 3.86141798017947*^9, 
   3.86194229328555*^9, 3.861942456922916*^9, {3.861942508083952*^9, 
   3.861942544491913*^9}, 3.861946315167163*^9, 3.8619468946123343`*^9, {
   3.861946949501602*^9, 3.861946981244851*^9}, {3.8619470876570587`*^9, 
   3.861947112083755*^9}, {3.8619476896190033`*^9, 3.861947712514051*^9}, 
   3.861947797024074*^9, 3.861947963602521*^9, 3.8619483149597197`*^9, 
   3.861948772656252*^9, 3.862023478815495*^9, {3.862030566707353*^9, 
   3.862030620579732*^9}, 3.862035134257084*^9, 3.862040685778339*^9, {
   3.862040774128024*^9, 3.862040835021727*^9}, 3.8620419619932537`*^9, 
   3.8620424742384157`*^9, 3.862042549162614*^9, 3.8620430332494392`*^9, {
   3.8620435245651007`*^9, 3.862043534246748*^9}, {3.862045015924087*^9, 
   3.8620450238540163`*^9}, 3.862045181771346*^9, 3.862045243427627*^9, {
   3.862117612537245*^9, 3.862117629761859*^9}, 3.862118302290781*^9, 
   3.862118651926703*^9, 3.862118823949031*^9, 3.862119022266375*^9, 
   3.86211907106711*^9, {3.8621191065166073`*^9, 3.862119112153892*^9}, 
   3.8621192029577913`*^9, {3.862119616961495*^9, 3.862119632096499*^9}, {
   3.862119720006658*^9, 3.8621197431628428`*^9}, 3.862119801441834*^9, 
   3.862119850569803*^9},
 CellLabel->
  "Out[1280]=",ExpressionUUID->"fac60891-ffa1-42ba-a22c-c9b0c682df05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vals", "[", 
  RowBox[{"[", "P", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"gs", "=", 
  RowBox[{"2", "*", 
   RowBox[{
    RowBox[{
     RowBox[{"vecs", "[", 
      RowBox[{"[", "P", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}]}]}], "Input",
 CellChangeTimes->{{3.861371018088653*^9, 3.861371053074421*^9}, {
  3.8613711049262037`*^9, 3.8613711170447903`*^9}, {3.861371314325594*^9, 
  3.861371315146274*^9}, {3.861942800551648*^9, 3.861942825289452*^9}, {
  3.8619430150508432`*^9, 3.861943017860402*^9}},
 CellLabel->
  "In[1281]:=",ExpressionUUID->"860cdb4e-1d91-43de-bea7-4d3a06bbf4b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.341581416633344`"}], ",", 
   RowBox[{"-", "1.3361535811007863`"}], ",", 
   RowBox[{"-", "1.1954147775043449`"}], ",", 
   RowBox[{"-", "0.7946903939127806`"}], ",", 
   RowBox[{"-", "0.39604156455057327`"}], ",", "0.8039598457366567`", ",", 
   "0.8052790208066084`", ",", "1.2052776162079883`", ",", 
   "1.6039623566297818`", ",", "2.1455423629758865`", ",", 
   "2.1506765404921953`", ",", "2.80462953540716`"}], "}"}]], "Output",
 CellChangeTimes->{{3.861371020501259*^9, 3.861371053528298*^9}, {
   3.8613711061611757`*^9, 3.861371162365239*^9}, 3.861371315652685*^9, 
   3.861417980204805*^9, 3.8619422933124657`*^9, 3.8619424569512978`*^9, {
   3.86194250810712*^9, 3.861942544515633*^9}, {3.86194280114185*^9, 
   3.861942825578306*^9}, 3.861943018316964*^9, 3.861946315190065*^9, 
   3.861946894640402*^9, {3.861946949516386*^9, 3.861946981267043*^9}, {
   3.861947087683784*^9, 3.861947112105978*^9}, {3.861947689636585*^9, 
   3.8619477125320463`*^9}, 3.861947797048182*^9, 3.861947963617195*^9, 
   3.861948314975863*^9, 3.861948772670888*^9, 3.862023478852501*^9, {
   3.862030566722837*^9, 3.862030620594304*^9}, 3.8620351342834253`*^9, 
   3.862040685800729*^9, {3.862040774142826*^9, 3.862040835035972*^9}, 
   3.8620419620101833`*^9, 3.862042474253665*^9, 3.862042549184683*^9, 
   3.86204303326646*^9, {3.862043524578907*^9, 3.86204353426117*^9}, {
   3.862045015937941*^9, 3.862045023879808*^9}, 3.862045181781767*^9, 
   3.8620452434400663`*^9, {3.862117612574916*^9, 3.8621176297876453`*^9}, 
   3.862118302315566*^9, 3.8621186519543343`*^9, 3.8621188239624233`*^9, 
   3.8621190222878733`*^9, 3.8621190710838823`*^9, {3.8621191065303497`*^9, 
   3.862119112165756*^9}, 3.862119202979289*^9, {3.86211961698275*^9, 
   3.862119632109899*^9}, {3.862119720041893*^9, 3.862119743178905*^9}, 
   3.862119801467731*^9, 3.862119850585176*^9},
 CellLabel->
  "Out[1281]=",ExpressionUUID->"f1a259e1-9ffc-4934-b058-ca78968ef694"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.22132256451413984`", ",", "1.0484694260890269`*^-27", ",", 
   "0.22132256451416954`", ",", "0.3722554668897051`", ",", 
   "0.09254970204097772`", ",", "0.09254970204100776`", ",", 
   "0.22132256451417043`", ",", "0.22132256451413918`", ",", 
   "1.0215522448692467`*^-27", ",", "0.09254970204100806`", ",", 
   "0.3722554668897044`", ",", "0.09254970204097847`"}], "}"}]], "Output",
 CellChangeTimes->{{3.861371020501259*^9, 3.861371053528298*^9}, {
   3.8613711061611757`*^9, 3.861371162365239*^9}, 3.861371315652685*^9, 
   3.861417980204805*^9, 3.8619422933124657`*^9, 3.8619424569512978`*^9, {
   3.86194250810712*^9, 3.861942544515633*^9}, {3.86194280114185*^9, 
   3.861942825578306*^9}, 3.861943018316964*^9, 3.861946315190065*^9, 
   3.861946894640402*^9, {3.861946949516386*^9, 3.861946981267043*^9}, {
   3.861947087683784*^9, 3.861947112105978*^9}, {3.861947689636585*^9, 
   3.8619477125320463`*^9}, 3.861947797048182*^9, 3.861947963617195*^9, 
   3.861948314975863*^9, 3.861948772670888*^9, 3.862023478852501*^9, {
   3.862030566722837*^9, 3.862030620594304*^9}, 3.8620351342834253`*^9, 
   3.862040685800729*^9, {3.862040774142826*^9, 3.862040835035972*^9}, 
   3.8620419620101833`*^9, 3.862042474253665*^9, 3.862042549184683*^9, 
   3.86204303326646*^9, {3.862043524578907*^9, 3.86204353426117*^9}, {
   3.862045015937941*^9, 3.862045023879808*^9}, 3.862045181781767*^9, 
   3.8620452434400663`*^9, {3.862117612574916*^9, 3.8621176297876453`*^9}, 
   3.862118302315566*^9, 3.8621186519543343`*^9, 3.8621188239624233`*^9, 
   3.8621190222878733`*^9, 3.8621190710838823`*^9, {3.8621191065303497`*^9, 
   3.862119112165756*^9}, 3.862119202979289*^9, {3.86211961698275*^9, 
   3.862119632109899*^9}, {3.862119720041893*^9, 3.862119743178905*^9}, 
   3.862119801467731*^9, 3.862119850592429*^9},
 CellLabel->
  "Out[1282]=",ExpressionUUID->"8171ff1c-d70c-4c54-a839-7515982f8e5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gs", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"#1", "-", "#2"}], "]"}], "<", 
       RowBox[{"10", "^", 
        RowBox[{"-", "10"}]}]}], ")"}], "&"}]}], "]"}], " ", "//", 
  "Sort"}]], "Input",
 CellChangeTimes->{{3.8620429798475637`*^9, 3.862042997732638*^9}, 
   3.862043101209278*^9, {3.862043141180531*^9, 3.862043142584791*^9}, {
   3.862117878661908*^9, 3.8621178958571568`*^9}, 3.862117935690832*^9, {
   3.862117977039647*^9, 3.8621180066665783`*^9}, {3.8621184326384563`*^9, 
   3.86211855202674*^9}},
 CellLabel->
  "In[1283]:=",ExpressionUUID->"43746040-b699-4f13-839d-dd1778351348"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0484694260890269`*^-27", ",", "0.09254970204097772`", ",", 
   "0.22132256451413984`", ",", "0.3722554668897051`"}], "}"}]], "Output",
 CellChangeTimes->{{3.86204298740606*^9, 3.862042998181715*^9}, 
   3.862043033301093*^9, 3.8620431017023487`*^9, 3.862043143117106*^9, {
   3.862043524617972*^9, 3.862043534303969*^9}, {3.862045015968931*^9, 
   3.8620450239163027`*^9}, 3.862045181821887*^9, 3.86204524347528*^9, {
   3.8621176125960693`*^9, 3.862117629813281*^9}, {3.862117888862802*^9, 
   3.862117896441885*^9}, 3.8621179361535263`*^9, {3.862117978484584*^9, 
   3.86211800712473*^9}, 3.862118302334717*^9, 3.8621184692859497`*^9, 
   3.862118553181532*^9, 3.862118651971498*^9, 3.862118823991856*^9, 
   3.8621190223090677`*^9, 3.8621190711231728`*^9, {3.8621191065592813`*^9, 
   3.862119112193263*^9}, 3.86211920300049*^9, {3.862119617034886*^9, 
   3.862119632141306*^9}, {3.8621197200676117`*^9, 3.862119743198266*^9}, 
   3.8621198014903507`*^9, 3.8621198506196203`*^9},
 CellLabel->
  "Out[1283]=",ExpressionUUID->"1b5c3d0b-dcaa-4f77-b3ea-634be87e8ddc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jp", "=", 
  RowBox[{"{", " ", 
   RowBox[{"1.0", ",", "0.1", ",", "0.01", ",", "0.0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.862117487204533*^9, 3.862117517999052*^9}, {
   3.862118273915821*^9, 3.862118287098377*^9}, 3.862119065922433*^9, {
   3.862119607888205*^9, 3.862119608516324*^9}},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"f57978bb-e273-4e6a-b983-cf81c7aa842b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "0.1`", ",", "0.01`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.862117510346155*^9, 3.86211751836595*^9}, {
   3.862117612629018*^9, 3.862117629838539*^9}, {3.86211828945755*^9, 
   3.862118302359827*^9}, 3.862118651996036*^9, 3.862118824005623*^9, 
   3.862119022328404*^9, {3.862119066776021*^9, 3.8621190711370296`*^9}, {
   3.8621191065747013`*^9, 3.862119112207443*^9}, 3.862119203022018*^9, {
   3.862119609111023*^9, 3.862119632157201*^9}, {3.862119720096163*^9, 
   3.8621197432193727`*^9}, 3.862119801527258*^9, 3.8621198506350193`*^9},
 CellLabel->
  "Out[1284]=",ExpressionUUID->"2a1ba0aa-4916-4b6c-8bc6-aec5e7eae7a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Lb", "=", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", "Jp"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.862117524763685*^9, 3.862117544934081*^9}},
 CellLabel->
  "In[1285]:=",ExpressionUUID->"f5968eef-40c0-42a4-a251-b5b58d62e826"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5`", ",", "0.9090909090909091`", ",", "0.9900990099009901`", ",", 
   "1.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.862119610975011*^9, 3.862119632183436*^9}, {
   3.862119720114027*^9, 3.862119743234714*^9}, 3.862119801542461*^9, 
   3.8621198506669703`*^9},
 CellLabel->
  "Out[1285]=",ExpressionUUID->"c0a0ab12-ef14-4462-8749-8b9d9f605aa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"5.0535260723595784", "e"}], "-", "31"}]], "Input",
 CellChangeTimes->{
  3.862118017257255*^9, {3.8621180522700567`*^9, 3.862118085310226*^9}, {
   3.862118335560704*^9, 3.862118336564313*^9}, {3.8621185837105207`*^9, 
   3.862118609777457*^9}, {3.862118667150282*^9, 3.862118668074924*^9}, {
   3.862118704991349*^9, 3.8621187774800262`*^9}, {3.8621188417659388`*^9, 
   3.862118842813159*^9}, {3.8621189231528893`*^9, 3.8621189242742443`*^9}, {
   3.862118957415716*^9, 3.862118959737276*^9}},
 FontWeight->"Plain",
 CellLabel->
  "In[1286]:=",ExpressionUUID->"7b58b94a-b5d4-487c-bf5f-57da24268865"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "31"}], "+", 
  RowBox[{"5.0535260723595785`", " ", "e"}]}]], "Output",
 CellChangeTimes->{
  3.862118652035532*^9, 3.86211882404066*^9, 3.86211902237747*^9, 
   3.8621190711853743`*^9, {3.862119106611858*^9, 3.862119112243842*^9}, 
   3.862119203055444*^9, {3.862119617126484*^9, 3.862119632194934*^9}, {
   3.8621197201427507`*^9, 3.8621197432469053`*^9}, 3.86211980156822*^9, 
   3.86211985068449*^9},
 CellLabel->
  "Out[1286]=",ExpressionUUID->"d01355df-cfa3-4e8b-a674-af367061c9dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["0.22892801778070834"], "Input",
 CellChangeTimes->{
  3.8621183659518003`*^9, {3.862118404467101*^9, 3.8621184057584057`*^9}, {
   3.862118884596814*^9, 3.862118885693884*^9}},
 CellLabel->
  "In[1287]:=",ExpressionUUID->"a31e1f3a-b72b-467d-b682-5a7901151bd7"],

Cell[BoxData["0.22892801778070834`"], "Output",
 CellChangeTimes->{
  3.8621186520632353`*^9, 3.862118824061756*^9, 3.862119022389593*^9, 
   3.862119071218026*^9, {3.862119106635968*^9, 3.862119112265751*^9}, 
   3.862119203066412*^9, {3.862119617178586*^9, 3.862119632223139*^9}, {
   3.862119720160898*^9, 3.862119743268235*^9}, 3.862119801583658*^9, 
   3.862119850711858*^9},
 CellLabel->
  "Out[1287]=",ExpressionUUID->"90884cf5-d81d-4c26-b2d0-c407a030a29a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Lb", "[", 
  RowBox[{"[", "4", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8621195897915697`*^9, 3.862119598541862*^9}},
 CellLabel->
  "In[1288]:=",ExpressionUUID->"d6a88aaa-666a-4abe-a43c-ce89ee6dacdc"],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{{3.862119599063752*^9, 3.862119632240004*^9}, {
   3.862119720193289*^9, 3.862119743282503*^9}, 3.862119801611684*^9, 
   3.862119850726021*^9},
 CellLabel->
  "Out[1288]=",ExpressionUUID->"ef5978e8-f672-4c83-a6a8-777d2a0602d7"]
}, Open  ]]
},
WindowSize->{1440, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a48db2fa-e6cd-4667-9321-ae593f910571"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1044, 31, 30, "Input",ExpressionUUID->"aba4b40d-f45c-4cee-be3b-35ac72edaae4"],
Cell[1627, 55, 2371, 50, 34, "Output",ExpressionUUID->"de60185b-0824-4102-8b70-ec0ebc76526b"]
}, Open  ]],
Cell[4013, 108, 791, 20, 94, "Input",ExpressionUUID->"30bec3d8-d1a1-4f2c-9b5a-9de8bfc18c92"],
Cell[CellGroupData[{
Cell[4829, 132, 481, 11, 30, "Input",ExpressionUUID->"f583b8be-6ecf-4a01-8439-7b2662e838cd"],
Cell[5313, 145, 2427, 51, 34, "Output",ExpressionUUID->"c6a7a662-20f3-47e7-aff2-0e31c22cf5d5"]
}, Open  ]],
Cell[7755, 199, 176, 3, 30, "Input",ExpressionUUID->"5af73150-af60-44b1-a233-1d6bbdd800e4"],
Cell[7934, 204, 13422, 292, 1375, "Input",ExpressionUUID->"38f27582-e20a-4fde-9ccf-031c87501e48"],
Cell[21359, 498, 110, 2, 30, "Input",ExpressionUUID->"3bec1489-3d1a-4fc2-b213-c7bc8724debc"],
Cell[21472, 502, 3205, 73, 451, "Input",ExpressionUUID->"ea8d2de9-c7e3-41b2-a460-53ac5aae1470"],
Cell[CellGroupData[{
Cell[24702, 579, 414, 10, 52, "Input",ExpressionUUID->"ec30578b-1931-4ff5-ab1c-12b2a9e615ff"],
Cell[25119, 591, 3543, 63, 230, "Output",ExpressionUUID->"0d04e2ac-2c19-4906-858c-bd7df60869c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28699, 659, 290, 7, 30, "Input",ExpressionUUID->"f7fb9726-94f5-49be-afb2-f87fadece320"],
Cell[28992, 668, 8799, 172, 307, "Output",ExpressionUUID->"4d8c671e-2b6b-4ec5-9d50-a6e82f116dae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37828, 845, 237, 5, 30, "Input",ExpressionUUID->"66541fe5-e4c1-46c8-bf34-782a1633ca48"],
Cell[38068, 852, 1621, 26, 34, "Output",ExpressionUUID->"fac60891-ffa1-42ba-a22c-c9b0c682df05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39726, 883, 646, 15, 52, "Input",ExpressionUUID->"860cdb4e-1d91-43de-bea7-4d3a06bbf4b4"],
Cell[40375, 900, 2001, 32, 34, "Output",ExpressionUUID->"f1a259e1-9ffc-4934-b058-ca78968ef694"],
Cell[42379, 934, 1937, 30, 37, "Output",ExpressionUUID->"8171ff1c-d70c-4c54-a839-7515982f8e5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44353, 969, 723, 18, 30, "Input",ExpressionUUID->"43746040-b699-4f13-839d-dd1778351348"],
Cell[45079, 989, 1111, 18, 37, "Output",ExpressionUUID->"1b5c3d0b-dcaa-4f77-b3ea-634be87e8ddc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46227, 1012, 403, 8, 30, "Input",ExpressionUUID->"f57978bb-e273-4e6a-b983-cf81c7aa842b"],
Cell[46633, 1022, 692, 11, 34, "Output",ExpressionUUID->"2a1ba0aa-4916-4b6c-8bc6-aec5e7eae7a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47362, 1038, 273, 7, 30, "Input",ExpressionUUID->"f5968eef-40c0-42a4-a251-b5b58d62e826"],
Cell[47638, 1047, 391, 9, 34, "Output",ExpressionUUID->"c0a0ab12-ef14-4462-8749-8b9d9f605aa4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48066, 1061, 636, 12, 30, "Input",ExpressionUUID->"7b58b94a-b5d4-487c-bf5f-57da24268865"],
Cell[48705, 1075, 527, 11, 34, "Output",ExpressionUUID->"d01355df-cfa3-4e8b-a674-af367061c9dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49269, 1091, 274, 5, 30, "Input",ExpressionUUID->"a31e1f3a-b72b-467d-b682-5a7901151bd7"],
Cell[49546, 1098, 464, 8, 34, "Output",ExpressionUUID->"90884cf5-d81d-4c26-b2d0-c407a030a29a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50047, 1111, 230, 5, 30, "Input",ExpressionUUID->"d6a88aaa-666a-4abe-a43c-ce89ee6dacdc"],
Cell[50280, 1118, 278, 5, 57, "Output",ExpressionUUID->"ef5978e8-f672-4c83-a6a8-777d2a0602d7"]
}, Open  ]]
}
]
*)

